<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <!-- Tree view for the menuitem -->
        <record id="izi_table_tree" model="ir.ui.view">
            <field name="name">izi.table.tree</field>
            <field name="model">izi.table</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="name"/>
                    <field name="source_id"/>
                    <field name="is_stored"/>
                    <field name="user_defined"/>
                </tree>
            </field>
        </record>

        <!-- Form view for the menuitem -->
        <record id="izi_table_form" model="ir.ui.view">
            <field name="name">izi.table.form</field>
            <field name="model">izi.table</field>
            <field name="arch" type="xml">
                <form>
                    <header>
                        <button string="Get Table Data" class="oe_highlight" name="get_table_datas" type="object" context="{'test_query': True}"/>
                        <button string="Get Table Fields" class="" name="get_table_fields" type="object" attrs="{'invisible': [('is_stored', '=', True)]}"/>
                        <button confirm="You are about to update the schema of the store table. If any fields change, the table will be rebuilt and the stored data will be deleted. Are you sure?" string="Update Store Table Fields" name="get_table_fields" type="object" attrs="{'invisible': [('is_stored', '=', False)]}"/>
                        <button confirm="You will run python code, this may take some time. Are you sure?" string="Run Python Code" name="run_python_code" type="object" attrs="{'invisible': [('is_stored', '=', False)]}"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <label for="name" class="oe_edit_only"/>
                            <h1>
                                <field name="name"/>
                            </h1>
                        </div>
                        <group>
                            <group>
                                <field name="source_id" attrs="{'readonly': [('id', '!=', False)]}" force_save="1"/>
                                <field name="is_stored"/>
                                <field name="table_name" invisible="1"/>
                            </group>
                        </group>
                        <group attrs="{'invisible': [('is_stored', '=', False)]}">
                            <group>
                                <field name="store_interval"/>
                                <field name="store_interval_custom_type" attrs="{'invisible': [('store_interval', '!=', 'custom')]}"/>
                                <field name="store_start_datetime" attrs="{'invisible': ['|', ('store_interval', '!=', 'custom'), ('store_interval_custom_type', '!=', 'datetime_range')]}"/>
                                <field name="store_end_datetime" attrs="{'invisible': ['|', ('store_interval', '!=', 'custom'), ('store_interval_custom_type', '!=', 'datetime_range')]}"/>
                                <label for="store_unit_of_time_value" string="Unit of Time" attrs="{'invisible': ['|', ('store_interval', '!=', 'custom'), ('store_interval_custom_type', '!=', 'unit_of_time')]}"/>
                                <div attrs="{'invisible': ['|', ('store_interval', '!=', 'custom'), ('store_interval_custom_type', '!=', 'unit_of_time')]}">
                                    <field name="store_unit_of_time_value" class="oe_inline"/>
                                    <field name="store_unit_of_time" class="oe_inline"/>
                                </div>
                            </group>
                        </group>
                        <group attrs="{'invisible': [('is_stored', '=', False)]}">
                            <group>
                                <field name="start_datetime"/>
                                <field name="end_datetime"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Fields">
                                <field name="field_ids" readonly="1">
                                    <tree>
                                        <field name="name"/>
                                        <field name="field_name"/>
                                        <field name="field_type"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Query" attrs="{'invisible': ['|', ('is_stored', '=', True), ('table_name', '!=', False)]}">
                                <field name="db_query" widget="ace" options="{'mode':'python'}"/>
                            </page>
                            <page string="Python Code" attrs="{'invisible': [('is_stored', '=', False)]}">
                                <field name="python_code_ids">
                                    <tree>
                                        <field name="name"/>
                                        <field name="type_code"/>
                                        <field name="sequence"/>
                                        <field name="python_code" widget="ace" options="{'mode':'python'}"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Analysis">
                                <field name="analysis_ids" readonly="1">
                                    <tree>
                                        <field name="name"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="izi_data.izi_table_python_code_form" model="ir.ui.view">
            <field name="name">izi.table.python.code.form</field>
            <field name="model">izi.table.python.code</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <div class="oe_title">
                            <label for="name" class="oe_edit_only"/>
                            <h1>
                                <field name="name"/>
                            </h1>
                        </div>
                        <group>
                            <group>
                                <field name="sequence"/>
                                <field name="type_code"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Python Code">
                                <field name="python_code" widget="ace" options="{'mode':'python'}"/>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>
    </data>
</odoo>